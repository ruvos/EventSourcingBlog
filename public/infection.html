<!DOCTYPE html>
<html>
    <body>
        <a href="/">Back</a>
        <mutation-test-report-app title-postfix="Infection"></mutation-test-report-app>
        <script defer src="https://cdn.jsdelivr.net/npm/mutation-testing-elements/dist/mutation-test-elements.js"></script>
        <script>
            const app = document.getElementsByTagName('mutation-test-report-app').item(0);
            function updateTheme() {
                document.body.style.backgroundColor = app.themeBackgroundColor;
            }
            app.addEventListener('theme-changed', updateTheme);
            updateTheme();

            document.getElementsByTagName('mutation-test-report-app').item(0).report = {"schemaVersion":"1","thresholds":{"high":90,"low":50},"files":{"Database\/SqLiteEventStore.php":{"language":"php","source":"<?php\n\nnamespace Ruvos\\Blog\\Database;\n\nuse Ruvos\\Blog\\DomainObject\\AbstractEvent;\nuse Ruvos\\Blog\\DomainObject\\Post\\Event\\PostCreatedEvent;\n\nfinal class SqLiteEventStore implements EventStore\n{\n    private ?\\PDO $pdo = null;\n\n    public function __construct(private string $dsn)\n    {\n    }\n\n    private function getConnection(): \\PDO\n    {\n        if (null === $this->pdo) {\n            $this->pdo = new \\PDO($this->dsn);\n\n            $this->createSchema();\n        }\n        return $this->pdo;\n    }\n\n    public function save(AbstractEvent $event): void\n    {\n        $payload = $event->toJson();\n\n        $connection = $this->getConnection();\n        $connection->beginTransaction();\n\n        $statement = $connection->prepare('\nINSERT INTO events (\n                    eventId,\n                    correlationId,\n                    topic,\n                    createdAt,\n                    payload\n                    ) VALUES (\n                              :eventId,\n                              :correlationId,\n                              :topic,\n                              :createdAt,\n                              :payload\n                              )\n                              ');\n        $statement->execute(\n            [\n                ':eventId' => $event->eventId,\n                ':correlationId' => $event->correlationId,\n                ':topic' => $event->getTopic(),\n                ':createdAt' => $event->createdAt->format('Y-m-d H:i:s.u'),\n                ':payload' => $payload\n            ]\n        );\n\n        $connection->commit();\n    }\n\n    private function createSchema(): void\n    {\n        $this->pdo->exec('\n        CREATE TABLE IF NOT EXISTS events (\n            eventId VARCHAR(36) PRIMARY KEY,\n            correlationId VARCHAR(36),\n            topic TEXT,\n            createdAt TEXT,\n            payload LONGTEXT\n        )');\n\n        $this->pdo->exec('CREATE INDEX IF NOT EXISTS idx_correlation_id ON events (correlationId)');\n        $this->pdo->exec('CREATE INDEX IF NOT EXISTS idx_topic ON events (topic)');\n    }\n\n    public function loadAll(): array\n    {\n        $statement = $this->pdo->prepare('SELECT * FROM events');\n\n        $statement->execute();\n        $eventsArray = $statement->fetchAll(\\PDO::FETCH_NAMED);\n\n        $events = [];\n\n        foreach ($eventsArray as $eventArray) {\n            switch ($eventArray['topic']) {\n                case PostCreatedEvent::getTopic():\n                    $events[] = PostCreatedEvent::fromJson($eventArray['payload']);\n            }\n        }\n\n        return $events;\n    }\n}\n","mutants":[{"id":"c79649b109e055cd6f33360cb0a7ed56","mutatorName":"Identical","replacement":"if (null !== $this->pdo) {","description":"Replaces an identical operator (`===`) with its counterpart the not identical operator (`!==`).","location":{"start":{"line":18,"column":9},"end":{"line":18,"column":35}},"status":"Killed","statusReason":"PHPUnit 12.1.6 by Sebastian Bergmann and contributors.\n\nRuntime:       PHP 8.3.19\nConfiguration: \/tmp\/infection\/phpunitConfiguration.c79649b109e055cd6f33360cb0a7ed56.infection.xml\n\nE                                                                   1 \/ 1 (100%)\n\nTime: 00:00.007, Memory: 12.00 MB\n\nThere was 1 error:\n\n1) Blog\\Tests\\Integration\\SqLiteEventStoreTest::testSaveIsValid\nTypeError: Ruvos\\Blog\\Database\\SqLiteEventStore::getConnection(): Return value must be of type PDO, null returned\n\n\/var\/www\/html\/src\/Database\/SqLiteEventStore.php:19\n\/var\/www\/html\/src\/Database\/SqLiteEventStore.php:24\n\/var\/www\/html\/tests\/Integration\/SqLiteEventStoreTest.php:35\n\nERRORS!\nTests: 1, Assertions: 0, Errors: 1.","coveredBy":["64ef5638c42ee3ff7b484611666b28c1"],"killedBy":["64ef5638c42ee3ff7b484611666b28c1"],"testsCompleted":1},{"id":"cca801467e32ec10a4eae1bdab981d09","mutatorName":"MethodCallRemoval","replacement":"","description":"Removes the method call.","location":{"start":{"line":21,"column":13},"end":{"line":21,"column":35}},"status":"Killed","statusReason":"PHPUnit 12.1.6 by Sebastian Bergmann and contributors.\n\nRuntime:       PHP 8.3.19\nConfiguration: \/tmp\/infection\/phpunitConfiguration.cca801467e32ec10a4eae1bdab981d09.infection.xml\n\nE                                                                   1 \/ 1 (100%)\n\nTime: 00:00.008, Memory: 12.00 MB\n\nThere was 1 error:\n\n1) Blog\\Tests\\Integration\\SqLiteEventStoreTest::testSaveIsValid\nPDOException: SQLSTATE[HY000]: General error: 1 no such table: events\n\n\/var\/www\/html\/src\/Database\/SqLiteEventStore.php:26\n\/var\/www\/html\/tests\/Integration\/SqLiteEventStoreTest.php:35\n\nERRORS!\nTests: 1, Assertions: 0, Errors: 1.","coveredBy":["64ef5638c42ee3ff7b484611666b28c1"],"killedBy":["64ef5638c42ee3ff7b484611666b28c1"],"testsCompleted":1},{"id":"cd840afa43c65132aff9d9f8a43704eb","mutatorName":"MethodCallRemoval","replacement":"","description":"Removes the method call.","location":{"start":{"line":31,"column":9},"end":{"line":31,"column":41}},"status":"Killed","statusReason":"PHPUnit 12.1.6 by Sebastian Bergmann and contributors.\n\nRuntime:       PHP 8.3.19\nConfiguration: \/tmp\/infection\/phpunitConfiguration.cd840afa43c65132aff9d9f8a43704eb.infection.xml\n\nE                                                                   1 \/ 1 (100%)\n\nTime: 00:00.035, Memory: 12.00 MB\n\nThere was 1 error:\n\n1) Blog\\Tests\\Integration\\SqLiteEventStoreTest::testSaveIsValid\nPDOException: There is no active transaction\n\n\/var\/www\/html\/src\/Database\/SqLiteEventStore.php:42\n\/var\/www\/html\/tests\/Integration\/SqLiteEventStoreTest.php:35\n\nERRORS!\nTests: 1, Assertions: 0, Errors: 1.","coveredBy":["64ef5638c42ee3ff7b484611666b28c1"],"killedBy":["64ef5638c42ee3ff7b484611666b28c1"],"testsCompleted":1},{"id":"9b64a3756c21130f9dbd9df668dcaf31","mutatorName":"MethodCallRemoval","replacement":"","description":"Removes the method call.","location":{"start":{"line":48,"column":9},"end":{"line":56,"column":11}},"status":"Killed","statusReason":"PHPUnit 12.1.6 by Sebastian Bergmann and contributors.\n\nRuntime:       PHP 8.3.19\nConfiguration: \/tmp\/infection\/phpunitConfiguration.9b64a3756c21130f9dbd9df668dcaf31.infection.xml\n\nF                                                                   1 \/ 1 (100%)\n\nTime: 00:00.030, Memory: 12.00 MB\n\nThere was 1 failure:\n\n1) Blog\\Tests\\Integration\\SqLiteEventStoreTest::testSaveIsValid\nFailed asserting that actual size 0 matches expected size 1.\n\n\/var\/www\/html\/tests\/Integration\/SqLiteEventStoreTest.php:41\n\nFAILURES!\nTests: 1, Assertions: 1, Failures: 1.","coveredBy":["64ef5638c42ee3ff7b484611666b28c1"],"killedBy":["64ef5638c42ee3ff7b484611666b28c1"],"testsCompleted":1},{"id":"89d084509e8d6fe8e11d3032704132ab","mutatorName":"ArrayItemRemoval","replacement":"$statement->execute([':correlationId' => $event->correlationId, ':topic' => $event->getTopic(), ':createdAt' => $event->createdAt->format('Y-m-d H:i:s.u'), ':payload' => $payload]);","description":"Removes an element of an array literal. For example:\n\n```php\n$x = [0, 1, 2];\n```\n\nWill be mutated to:\n\n```php\n$x = [1, 2];\n```\n\nAnd:\n\n```php\n$x = [0, 2];\n```\n\nAnd:\n\n```php\n$x = [0, 1];\n```\n\nWhich elements it removes or how many elements it will attempt to remove will depend on its\nconfiguration.\n","location":{"start":{"line":49,"column":13},"end":{"line":55,"column":14}},"status":"Survived","statusReason":"PHPUnit 12.1.6 by Sebastian Bergmann and contributors.\n\nRuntime:       PHP 8.3.19\nConfiguration: \/tmp\/infection\/phpunitConfiguration.89d084509e8d6fe8e11d3032704132ab.infection.xml\n\n.                                                                   1 \/ 1 (100%)\n\nTime: 00:00.033, Memory: 12.00 MB\n\nOK (1 test, 1 assertion)","coveredBy":["64ef5638c42ee3ff7b484611666b28c1"],"killedBy":[],"testsCompleted":0},{"id":"ab9a333bb89693576e6bc92367942833","mutatorName":"ArrayItem","replacement":"$statement->execute([':eventId' > $event->eventId, ':correlationId' => $event->correlationId, ':topic' => $event->getTopic(), ':createdAt' => $event->createdAt->format('Y-m-d H:i:s.u'), ':payload' => $payload]);","description":"Replaces a key-value pair (`[$key => $value]`) array declaration with a value array declaration\n(`[$key > $value]`) where the key or the value are potentially impure (i.e. have a side-effect);\nFor example `[foo() => $b->bar]`.","location":{"start":{"line":50,"column":17},"end":{"line":50,"column":47}},"status":"Survived","statusReason":"PHPUnit 12.1.6 by Sebastian Bergmann and contributors.\n\nRuntime:       PHP 8.3.19\nConfiguration: \/tmp\/infection\/phpunitConfiguration.ab9a333bb89693576e6bc92367942833.infection.xml\n\n.                                                                   1 \/ 1 (100%)\n\nTime: 00:00.033, Memory: 12.00 MB\n\nOK (1 test, 1 assertion)","coveredBy":["64ef5638c42ee3ff7b484611666b28c1"],"killedBy":[],"testsCompleted":0},{"id":"d51be519c5f59d3fc28a6c4e897159bd","mutatorName":"ArrayItem","replacement":"$statement->execute([':eventId' => $event->eventId, ':correlationId' > $event->correlationId, ':topic' => $event->getTopic(), ':createdAt' => $event->createdAt->format('Y-m-d H:i:s.u'), ':payload' => $payload]);","description":"Replaces a key-value pair (`[$key => $value]`) array declaration with a value array declaration\n(`[$key > $value]`) where the key or the value are potentially impure (i.e. have a side-effect);\nFor example `[foo() => $b->bar]`.","location":{"start":{"line":51,"column":17},"end":{"line":51,"column":59}},"status":"Survived","statusReason":"PHPUnit 12.1.6 by Sebastian Bergmann and contributors.\n\nRuntime:       PHP 8.3.19\nConfiguration: \/tmp\/infection\/phpunitConfiguration.d51be519c5f59d3fc28a6c4e897159bd.infection.xml\n\n.                                                                   1 \/ 1 (100%)\n\nTime: 00:00.032, Memory: 12.00 MB\n\nOK (1 test, 1 assertion)","coveredBy":["64ef5638c42ee3ff7b484611666b28c1"],"killedBy":[],"testsCompleted":0},{"id":"bcd1eefe3d624720a7d91d32e7d730bf","mutatorName":"ArrayItem","replacement":"$statement->execute([':eventId' => $event->eventId, ':correlationId' => $event->correlationId, ':topic' > $event->getTopic(), ':createdAt' => $event->createdAt->format('Y-m-d H:i:s.u'), ':payload' => $payload]);","description":"Replaces a key-value pair (`[$key => $value]`) array declaration with a value array declaration\n(`[$key > $value]`) where the key or the value are potentially impure (i.e. have a side-effect);\nFor example `[foo() => $b->bar]`.","location":{"start":{"line":52,"column":17},"end":{"line":52,"column":48}},"status":"Killed","statusReason":"PHPUnit 12.1.6 by Sebastian Bergmann and contributors.\n\nRuntime:       PHP 8.3.19\nConfiguration: \/tmp\/infection\/phpunitConfiguration.bcd1eefe3d624720a7d91d32e7d730bf.infection.xml\n\nF                                                                   1 \/ 1 (100%)\n\nTime: 00:00.035, Memory: 12.00 MB\n\nThere was 1 failure:\n\n1) Blog\\Tests\\Integration\\SqLiteEventStoreTest::testSaveIsValid\nFailed asserting that actual size 0 matches expected size 1.\n\n\/var\/www\/html\/tests\/Integration\/SqLiteEventStoreTest.php:41\n\nFAILURES!\nTests: 1, Assertions: 1, Failures: 1.","coveredBy":["64ef5638c42ee3ff7b484611666b28c1"],"killedBy":["64ef5638c42ee3ff7b484611666b28c1"],"testsCompleted":1},{"id":"961a69c7a28f4a15bbd282fa9124f03c","mutatorName":"ArrayItem","replacement":"$statement->execute([':eventId' => $event->eventId, ':correlationId' => $event->correlationId, ':topic' => $event->getTopic(), ':createdAt' > $event->createdAt->format('Y-m-d H:i:s.u'), ':payload' => $payload]);","description":"Replaces a key-value pair (`[$key => $value]`) array declaration with a value array declaration\n(`[$key > $value]`) where the key or the value are potentially impure (i.e. have a side-effect);\nFor example `[foo() => $b->bar]`.","location":{"start":{"line":53,"column":17},"end":{"line":53,"column":76}},"status":"Survived","statusReason":"PHPUnit 12.1.6 by Sebastian Bergmann and contributors.\n\nRuntime:       PHP 8.3.19\nConfiguration: \/tmp\/infection\/phpunitConfiguration.961a69c7a28f4a15bbd282fa9124f03c.infection.xml\n\n.                                                                   1 \/ 1 (100%)\n\nTime: 00:00.033, Memory: 12.00 MB\n\nOK (1 test, 1 assertion)","coveredBy":["64ef5638c42ee3ff7b484611666b28c1"],"killedBy":[],"testsCompleted":0},{"id":"b670ffa81657c586bd98ab7adca8c25f","mutatorName":"MethodCallRemoval","replacement":"","description":"Removes the method call.","location":{"start":{"line":58,"column":9},"end":{"line":58,"column":31}},"status":"Survived","statusReason":"PHPUnit 12.1.6 by Sebastian Bergmann and contributors.\n\nRuntime:       PHP 8.3.19\nConfiguration: \/tmp\/infection\/phpunitConfiguration.b670ffa81657c586bd98ab7adca8c25f.infection.xml\n\n.                                                                   1 \/ 1 (100%)\n\nTime: 00:00.027, Memory: 12.00 MB\n\nOK (1 test, 1 assertion)","coveredBy":["64ef5638c42ee3ff7b484611666b28c1"],"killedBy":[],"testsCompleted":0},{"id":"3e97b3435d11ea0875eb3ba5ba6a0c70","mutatorName":"MethodCallRemoval","replacement":"","description":"Removes the method call.","location":{"start":{"line":63,"column":9},"end":{"line":70,"column":13}},"status":"Killed","statusReason":"PHPUnit 12.1.6 by Sebastian Bergmann and contributors.\n\nRuntime:       PHP 8.3.19\nConfiguration: \/tmp\/infection\/phpunitConfiguration.3e97b3435d11ea0875eb3ba5ba6a0c70.infection.xml\n\nE                                                                   1 \/ 1 (100%)\n\nTime: 00:00.008, Memory: 12.00 MB\n\nThere was 1 error:\n\n1) Blog\\Tests\\Integration\\SqLiteEventStoreTest::testSaveIsValid\nPDOException: SQLSTATE[HY000]: General error: 1 no such table: main.events\n\n\/var\/www\/html\/src\/Database\/SqLiteEventStore.php:47\n\/var\/www\/html\/src\/Database\/SqLiteEventStore.php:17\n\/var\/www\/html\/src\/Database\/SqLiteEventStore.php:24\n\/var\/www\/html\/tests\/Integration\/SqLiteEventStoreTest.php:35\n\nERRORS!\nTests: 1, Assertions: 0, Errors: 1.","coveredBy":["64ef5638c42ee3ff7b484611666b28c1"],"killedBy":["64ef5638c42ee3ff7b484611666b28c1"],"testsCompleted":1},{"id":"cbb4f97998e88bf2d6fda60b366307d4","mutatorName":"MethodCallRemoval","replacement":"","description":"Removes the method call.","location":{"start":{"line":72,"column":9},"end":{"line":72,"column":101}},"status":"Survived","statusReason":"PHPUnit 12.1.6 by Sebastian Bergmann and contributors.\n\nRuntime:       PHP 8.3.19\nConfiguration: \/tmp\/infection\/phpunitConfiguration.cbb4f97998e88bf2d6fda60b366307d4.infection.xml\n\n.                                                                   1 \/ 1 (100%)\n\nTime: 00:00.025, Memory: 12.00 MB\n\nOK (1 test, 1 assertion)","coveredBy":["64ef5638c42ee3ff7b484611666b28c1"],"killedBy":[],"testsCompleted":0},{"id":"752abcc4596a6844fbdc709f94c3bf0c","mutatorName":"MethodCallRemoval","replacement":"","description":"Removes the method call.","location":{"start":{"line":73,"column":9},"end":{"line":73,"column":84}},"status":"Survived","statusReason":"PHPUnit 12.1.6 by Sebastian Bergmann and contributors.\n\nRuntime:       PHP 8.3.19\nConfiguration: \/tmp\/infection\/phpunitConfiguration.752abcc4596a6844fbdc709f94c3bf0c.infection.xml\n\n.                                                                   1 \/ 1 (100%)\n\nTime: 00:00.025, Memory: 12.00 MB\n\nOK (1 test, 1 assertion)","coveredBy":["64ef5638c42ee3ff7b484611666b28c1"],"killedBy":[],"testsCompleted":0},{"id":"edb42235528ccd7fb5e87dd7df7e1654","mutatorName":"MethodCallRemoval","replacement":"","description":"Removes the method call.","location":{"start":{"line":80,"column":9},"end":{"line":80,"column":31}},"status":"Killed","statusReason":"PHPUnit 12.1.6 by Sebastian Bergmann and contributors.\n\nRuntime:       PHP 8.3.19\nConfiguration: \/tmp\/infection\/phpunitConfiguration.edb42235528ccd7fb5e87dd7df7e1654.infection.xml\n\nF                                                                   1 \/ 1 (100%)\n\nTime: 00:00.035, Memory: 12.00 MB\n\nThere was 1 failure:\n\n1) Blog\\Tests\\Integration\\SqLiteEventStoreTest::testSaveIsValid\nFailed asserting that actual size 0 matches expected size 1.\n\n\/var\/www\/html\/tests\/Integration\/SqLiteEventStoreTest.php:41\n\nFAILURES!\nTests: 1, Assertions: 1, Failures: 1.","coveredBy":["64ef5638c42ee3ff7b484611666b28c1"],"killedBy":["64ef5638c42ee3ff7b484611666b28c1"],"testsCompleted":1},{"id":"80d2cf42fa6965375928c81465ce12fd","mutatorName":"Foreach_","replacement":"foreach ([] as $eventArray) {","description":"Replaces the iterable being iterated over with a `foreach` statement with an empty array, preventing\nany statement within the block to be executed. For example:\n\n```php`\nforeach ($a as $b) {\n    \/\/ ...\n}\n```\n\nWill be mutated to:\n\n```php\nfor ([] as $b]) {\n    \/\/ ...\n}\n```","location":{"start":{"line":85,"column":9},"end":{"line":90,"column":48}},"status":"Killed","statusReason":"PHPUnit 12.1.6 by Sebastian Bergmann and contributors.\n\nRuntime:       PHP 8.3.19\nConfiguration: \/tmp\/infection\/phpunitConfiguration.80d2cf42fa6965375928c81465ce12fd.infection.xml\n\nF                                                                   1 \/ 1 (100%)\n\nTime: 00:00.034, Memory: 12.00 MB\n\nThere was 1 failure:\n\n1) Blog\\Tests\\Integration\\SqLiteEventStoreTest::testSaveIsValid\nFailed asserting that actual size 0 matches expected size 1.\n\n\/var\/www\/html\/tests\/Integration\/SqLiteEventStoreTest.php:41\n\nFAILURES!\nTests: 1, Assertions: 1, Failures: 1.","coveredBy":["64ef5638c42ee3ff7b484611666b28c1"],"killedBy":["64ef5638c42ee3ff7b484611666b28c1"],"testsCompleted":1},{"id":"b0d1a8762f773a5ec3bae9e469ec94c6","mutatorName":"ArrayOneItem","replacement":"return count($events) > 1 ? array_slice($events, 0, 1, true) : $events;","description":"Leaves only one item in the returned array. For example:\n\n```php\nreturn $array;\n```\n\nWill be mutated to:\n\n```php\nreturn count($array) > 1 ?\n    array_slice($array, 0, 1, true) :\n    $array\n;\n```\n","location":{"start":{"line":92,"column":9},"end":{"line":92,"column":24}},"status":"Survived","statusReason":"PHPUnit 12.1.6 by Sebastian Bergmann and contributors.\n\nRuntime:       PHP 8.3.19\nConfiguration: \/tmp\/infection\/phpunitConfiguration.b0d1a8762f773a5ec3bae9e469ec94c6.infection.xml\n\n.                                                                   1 \/ 1 (100%)\n\nTime: 00:00.033, Memory: 12.00 MB\n\nOK (1 test, 1 assertion)","coveredBy":["64ef5638c42ee3ff7b484611666b28c1"],"killedBy":[],"testsCompleted":0}]},"DomainObject\/AbstractEvent.php":{"language":"php","source":"<?php\n\ndeclare(strict_types=1);\n\nnamespace Ruvos\\Blog\\DomainObject;\n\nabstract readonly class AbstractEvent implements Event\n{\n    protected function __construct(\n        public string $correlationId,\n        public string $eventId,\n        public \\DateTimeInterface $createdAt\n    ) {\n    }\n}\n","mutants":[{"id":"7bd132b57a603795fa12a03a021aa0ec","mutatorName":"ProtectedVisibility","replacement":"private function __construct(public string $correlationId, public string $eventId, public \\DateTimeInterface $createdAt)","description":"Replaces the `protected` method visibility keyword with `private`.","location":{"start":{"line":9,"column":5},"end":{"line":9,"column":36}},"status":"Killed","statusReason":"PHPUnit 12.1.6 by Sebastian Bergmann and contributors.\n\nRuntime:       PHP 8.3.19\nConfiguration: \/tmp\/infection\/phpunitConfiguration.7bd132b57a603795fa12a03a021aa0ec.infection.xml\n\n.E\n\nTime: 00:00.007, Memory: 12.00 MB\n\nThere was 1 error:\n\n1) Blog\\Tests\\Unit\\Post\\Event\\PostCreatedEventTest::testToJsonIsValid\nError: Cannot call private Ruvos\\Blog\\DomainObject\\AbstractEvent::__construct()\n\n\/var\/www\/html\/src\/DomainObject\/Post\/Event\/PostCreatedEvent.php:27\n\/var\/www\/html\/src\/DomainObject\/Post\/Event\/PostCreatedEvent.php:36\n\/var\/www\/html\/tests\/Unit\/Post\/Event\/PostCreatedEventTest.php:53\n\nERRORS!\nTests: 2, Assertions: 1, Errors: 1.","coveredBy":["1cc7876205d48b19fbe9172f8218b4f4","e5b8be9903130ce8bc5b7201cea6c7c9","8ec0d35f0017dbab68eb811052c69a04","790e80b782ab58c130d4af4dd4737b53","546f2f99ba298ac94227318dab48ed8b"],"killedBy":["790e80b782ab58c130d4af4dd4737b53"],"testsCompleted":2}]},"DomainObject\/AbstractRepository.php":{"language":"php","source":"<?php\n\nnamespace Ruvos\\Blog\\DomainObject;\n\nuse Ruvos\\Blog\\Database\\EventStore;\n\nabstract readonly class AbstractRepository implements DomainObjectRepository\n{\n    public function __construct(protected EventStore $eventStore)\n    {\n    }\n\n    protected function sortEvents(array $events): array\n    {\n        $sortedEvents = [];\n\n        foreach ($events as $event) {\n            $sortedEvents[$event->correlationId][] = $event;\n        }\n\n        return $sortedEvents;\n    }\n\n    protected function buildPostsFromEvents(array $postEvents): array\n    {\n        $posts = [];\n\n        foreach ($postEvents as $events) {\n            $posts[] = $this->getRelevantDomainObject()::fromEvents($events);\n        }\n\n        return $posts;\n    }\n\n    public function loadAll(): array\n    {\n        $events = $this->eventStore->loadAll();\n        $posts = $this->sortEvents($events);\n\n        return $this->buildPostsFromEvents($posts);\n    }\n}\n","mutants":[{"id":"cf55504bf77523a18cc703a9cd147978","mutatorName":"ProtectedVisibility","replacement":"private function sortEvents(array $events): array","description":"Replaces the `protected` method visibility keyword with `private`.","location":{"start":{"line":13,"column":5},"end":{"line":13,"column":56}},"status":"NoCoverage","statusReason":"","coveredBy":[],"killedBy":[],"testsCompleted":0},{"id":"d3f27000a8891d5347cfabd800c01357","mutatorName":"Foreach_","replacement":"foreach ([] as $event) {","description":"Replaces the iterable being iterated over with a `foreach` statement with an empty array, preventing\nany statement within the block to be executed. For example:\n\n```php`\nforeach ($a as $b) {\n    \/\/ ...\n}\n```\n\nWill be mutated to:\n\n```php\nfor ([] as $b]) {\n    \/\/ ...\n}\n```","location":{"start":{"line":17,"column":9},"end":{"line":19,"column":38}},"status":"NoCoverage","statusReason":"","coveredBy":[],"killedBy":[],"testsCompleted":0},{"id":"1d3627b468dce5422c3c9fa9e8d5630b","mutatorName":"ArrayOneItem","replacement":"return count($sortedEvents) > 1 ? array_slice($sortedEvents, 0, 1, true) : $sortedEvents;","description":"Leaves only one item in the returned array. For example:\n\n```php\nreturn $array;\n```\n\nWill be mutated to:\n\n```php\nreturn count($array) > 1 ?\n    array_slice($array, 0, 1, true) :\n    $array\n;\n```\n","location":{"start":{"line":21,"column":9},"end":{"line":21,"column":30}},"status":"NoCoverage","statusReason":"","coveredBy":[],"killedBy":[],"testsCompleted":0},{"id":"99a2972b123fe3d448e159dad18d7b2d","mutatorName":"ProtectedVisibility","replacement":"private function buildPostsFromEvents(array $postEvents): array","description":"Replaces the `protected` method visibility keyword with `private`.","location":{"start":{"line":24,"column":5},"end":{"line":24,"column":70}},"status":"NoCoverage","statusReason":"","coveredBy":[],"killedBy":[],"testsCompleted":0},{"id":"d5374a78015f6c38ecbc03b0fc734f7d","mutatorName":"Foreach_","replacement":"foreach ([] as $events) {","description":"Replaces the iterable being iterated over with a `foreach` statement with an empty array, preventing\nany statement within the block to be executed. For example:\n\n```php`\nforeach ($a as $b) {\n    \/\/ ...\n}\n```\n\nWill be mutated to:\n\n```php\nfor ([] as $b]) {\n    \/\/ ...\n}\n```","location":{"start":{"line":28,"column":9},"end":{"line":30,"column":43}},"status":"NoCoverage","statusReason":"","coveredBy":[],"killedBy":[],"testsCompleted":0},{"id":"1a52b618a110926ee12affdd45af02e6","mutatorName":"ArrayOneItem","replacement":"return count($posts) > 1 ? array_slice($posts, 0, 1, true) : $posts;","description":"Leaves only one item in the returned array. For example:\n\n```php\nreturn $array;\n```\n\nWill be mutated to:\n\n```php\nreturn count($array) > 1 ?\n    array_slice($array, 0, 1, true) :\n    $array\n;\n```\n","location":{"start":{"line":32,"column":9},"end":{"line":32,"column":23}},"status":"NoCoverage","statusReason":"","coveredBy":[],"killedBy":[],"testsCompleted":0}]},"DomainObject\/Post\/Event\/PostCreatedEvent.php":{"language":"php","source":"<?php\n\ndeclare(strict_types=1);\n\nnamespace Ruvos\\Blog\\DomainObject\\Post\\Event;\n\nuse DateTimeImmutable;\nuse Ruvos\\Blog\\DomainObject\\AbstractEvent;\nuse Ruvos\\Blog\\DomainObject\\Event;\nuse Ruvos\\Blog\\Utils\\DefaultDateTimeProvider;\nuse Ruvos\\Blog\\Utils\\DefaultUuidProvider;\n\nfinal readonly class PostCreatedEvent extends AbstractEvent\n{\n    private const string TOPIC = 'post.created';\n    public static function getTopic(): string\n    {\n        return self::TOPIC;\n    }\n\n    private function __construct(\n        string $eventId,\n        string $correlationId,\n        \\DateTimeInterface $createdAt,\n        public string $title\n    ) {\n        parent::__construct($correlationId, $eventId, $createdAt);\n    }\n\n    public static function create(string $title): Event\n    {\n        $createdAt = DefaultDateTimeProvider::now();\n        $correlationId = DefaultUuidProvider::v4();\n        $eventId = DefaultUuidProvider::v4();\n\n        return new self($eventId, $correlationId, $createdAt, $title);\n    }\n\n    public static function fromJson(string $payload)\n    {\n        $data = json_decode($payload, true, 512, JSON_THROW_ON_ERROR);\n        return new self(\n            $data['eventId'],\n            $data['correlationId'],\n            new DateTimeImmutable($data['createdAt']['date'], new \\DateTimeZone($data['createdAt']['timezone'])),\n            $data['title']\n        );\n    }\n\n    public function toJson(): string\n    {\n        return json_encode($this, JSON_THROW_ON_ERROR);\n    }\n}\n","mutants":[{"id":"114851390a515b9bd5030c9aae061a6a","mutatorName":"MethodCallRemoval","replacement":"","description":"Removes the method call.","location":{"start":{"line":27,"column":9},"end":{"line":27,"column":67}},"status":"Killed","statusReason":"PHPUnit 12.1.6 by Sebastian Bergmann and contributors.\n\nRuntime:       PHP 8.3.19\nConfiguration: \/tmp\/infection\/phpunitConfiguration.114851390a515b9bd5030c9aae061a6a.infection.xml\n\nE\n\nTime: 00:00.006, Memory: 12.00 MB\n\nThere was 1 error:\n\n1) Blog\\Tests\\Unit\\Post\\Event\\PostCreatedEventTest::testCreatedAtIsValid\nError: Typed property Ruvos\\Blog\\DomainObject\\AbstractEvent::$createdAt must not be accessed before initialization\n\n\/var\/www\/html\/tests\/Unit\/Post\/Event\/PostCreatedEventTest.php:41\n\nERRORS!\nTests: 1, Assertions: 0, Errors: 1.","coveredBy":["1cc7876205d48b19fbe9172f8218b4f4","e5b8be9903130ce8bc5b7201cea6c7c9","8ec0d35f0017dbab68eb811052c69a04","790e80b782ab58c130d4af4dd4737b53","546f2f99ba298ac94227318dab48ed8b"],"killedBy":["8ec0d35f0017dbab68eb811052c69a04"],"testsCompleted":1},{"id":"e28930367488de26f33c1bd8c27b645b","mutatorName":"PublicVisibility","replacement":"protected static function create(string $title): Event","description":"Replaces the `public` method visibility keyword with `protected`.","location":{"start":{"line":30,"column":5},"end":{"line":30,"column":56}},"status":"Killed","statusReason":"PHPUnit 12.1.6 by Sebastian Bergmann and contributors.\n\nRuntime:       PHP 8.3.19\nConfiguration: \/tmp\/infection\/phpunitConfiguration.e28930367488de26f33c1bd8c27b645b.infection.xml\n\nE\n\nTime: 00:00.003, Memory: 10.00 MB\n\nThere was 1 error:\n\n1) Blog\\Tests\\Unit\\Post\\Event\\PostCreatedEventTest::testTitleIsCorrectSet\nError: Call to protected method Ruvos\\Blog\\DomainObject\\Post\\Event\\PostCreatedEvent::create() from scope Blog\\Tests\\Unit\\Post\\Event\\PostCreatedEventTest\n\n\/var\/www\/html\/tests\/Unit\/Post\/Event\/PostCreatedEventTest.php:33\n\nERRORS!\nTests: 1, Assertions: 0, Errors: 1.","coveredBy":["1cc7876205d48b19fbe9172f8218b4f4","e5b8be9903130ce8bc5b7201cea6c7c9","8ec0d35f0017dbab68eb811052c69a04","790e80b782ab58c130d4af4dd4737b53","546f2f99ba298ac94227318dab48ed8b"],"killedBy":["e5b8be9903130ce8bc5b7201cea6c7c9"],"testsCompleted":1},{"id":"f37e15ef15288fcfe3aad9cdcb160a3c","mutatorName":"PublicVisibility","replacement":"protected static function fromJson(string $payload)","description":"Replaces the `public` method visibility keyword with `protected`.","location":{"start":{"line":39,"column":5},"end":{"line":39,"column":53}},"status":"Killed","statusReason":"PHPUnit 12.1.6 by Sebastian Bergmann and contributors.\n\nRuntime:       PHP 8.3.19\nConfiguration: \/tmp\/infection\/phpunitConfiguration.f37e15ef15288fcfe3aad9cdcb160a3c.infection.xml\n\n.....E                                                              6 \/ 6 (100%)\n\nTime: 00:00.007, Memory: 12.00 MB\n\nThere was 1 error:\n\n1) Blog\\Tests\\Unit\\Post\\Event\\PostCreatedEventTest::testFromJsonIsValid\nError: Call to protected method Ruvos\\Blog\\DomainObject\\Post\\Event\\PostCreatedEvent::fromJson() from scope Blog\\Tests\\Unit\\Post\\Event\\PostCreatedEventTest\n\n\/var\/www\/html\/tests\/Unit\/Post\/Event\/PostCreatedEventTest.php:60\n\nERRORS!\nTests: 6, Assertions: 6, Errors: 1.","coveredBy":["546f2f99ba298ac94227318dab48ed8b"],"killedBy":["546f2f99ba298ac94227318dab48ed8b"],"testsCompleted":6},{"id":"b28fbcf21bfab7b93abc3a5ada0f6630","mutatorName":"DecrementInteger","replacement":"$data = json_decode($payload, true, 511, JSON_THROW_ON_ERROR);","description":"Decrements an integer value with 1.","location":{"start":{"line":41,"column":9},"end":{"line":41,"column":71}},"status":"Survived","statusReason":"PHPUnit 12.1.6 by Sebastian Bergmann and contributors.\n\nRuntime:       PHP 8.3.19\nConfiguration: \/tmp\/infection\/phpunitConfiguration.b28fbcf21bfab7b93abc3a5ada0f6630.infection.xml\n\n......                                                              6 \/ 6 (100%)\n\nTime: 00:00.005, Memory: 12.00 MB\n\nOK (6 tests, 7 assertions)","coveredBy":["546f2f99ba298ac94227318dab48ed8b"],"killedBy":[],"testsCompleted":0},{"id":"f0e5a0ba02c9b3635da610ffbd760641","mutatorName":"IncrementInteger","replacement":"$data = json_decode($payload, true, 513, JSON_THROW_ON_ERROR);","description":"Increments an integer value with 1.","location":{"start":{"line":41,"column":9},"end":{"line":41,"column":71}},"status":"Survived","statusReason":"PHPUnit 12.1.6 by Sebastian Bergmann and contributors.\n\nRuntime:       PHP 8.3.19\nConfiguration: \/tmp\/infection\/phpunitConfiguration.f0e5a0ba02c9b3635da610ffbd760641.infection.xml\n\n......                                                              6 \/ 6 (100%)\n\nTime: 00:00.005, Memory: 12.00 MB\n\nOK (6 tests, 7 assertions)","coveredBy":["546f2f99ba298ac94227318dab48ed8b"],"killedBy":[],"testsCompleted":0},{"id":"3127af7f846d639658f08c17dfb994a9","mutatorName":"NewObject","replacement":"new self($data['eventId'], $data['correlationId'], new DateTimeImmutable($data['createdAt']['date'], new \\DateTimeZone($data['createdAt']['timezone'])), $data['title']);\n        return null;","description":"Replaces a newly instantiated object with `null` instead. The instantiation statement is kept in order\nto preserve potential side effects. Example:\n\n```php\nclass X {\n    function foo(): ?stdClass\n    {\n        return new stdClass();\n    }\n}\n```\n\nWill be mutated to:\n\n```php\nclass X {\n    function foo(): ?stdClass\n    {\n        new stdClass();\n        return null;\n    }\n}\n```\n","location":{"start":{"line":42,"column":9},"end":{"line":47,"column":25}},"status":"Killed","statusReason":"PHPUnit 12.1.6 by Sebastian Bergmann and contributors.\n\nRuntime:       PHP 8.3.19\nConfiguration: \/tmp\/infection\/phpunitConfiguration.3127af7f846d639658f08c17dfb994a9.infection.xml\n\n.....F                                                              6 \/ 6 (100%)\n\nTime: 00:00.008, Memory: 12.00 MB\n\nThere was 1 failure:\n\n1) Blog\\Tests\\Unit\\Post\\Event\\PostCreatedEventTest::testFromJsonIsValid\nFailed asserting that null is an instance of class Ruvos\\Blog\\DomainObject\\Post\\Event\\PostCreatedEvent.\n\n\/var\/www\/html\/tests\/Unit\/Post\/Event\/PostCreatedEventTest.php:60\n\nFAILURES!\nTests: 6, Assertions: 7, Failures: 1.","coveredBy":["546f2f99ba298ac94227318dab48ed8b"],"killedBy":["546f2f99ba298ac94227318dab48ed8b"],"testsCompleted":6}]},"DomainObject\/Post\/Post.php":{"language":"php","source":"<?php\n\ndeclare(strict_types=1);\n\nnamespace Ruvos\\Blog\\DomainObject\\Post;\n\nuse Ruvos\\Blog\\DomainObject\\AbstractDomainObject;\nuse Ruvos\\Blog\\DomainObject\\Event;\nuse Ruvos\\Blog\\DomainObject\\Exception\\DomainObjectException;\nuse Ruvos\\Blog\\DomainObject\\Post\\Event\\PostCreatedEvent;\n\nfinal class Post extends AbstractDomainObject\n{\n    private string $title;\n\n    public static function create(string $title): self\n    {\n        $createdEvent = PostCreatedEvent::create($title);\n\n        $that = new self();\n        $that->recordEvent($createdEvent);\n\n        return $that;\n    }\n\n    public function getTitle(): string\n    {\n        return $this->title;\n    }\n\n    protected function applyEvent(Event $event): void\n    {\n        switch ($event::getTopic()) {\n            case PostCreatedEvent::getTopic():\n                $this->applyPostCreatedEvent($event);\n                break;\n            default:\n                throw DomainObjectException::unsupportedEvent($event);\n        }\n    }\n\n    private function applyPostCreatedEvent(Event $event): void\n    {\n        $this->title = $event->title;\n        $this->updatedAt = $event->createdAt;\n        $this->correlationId = $event->correlationId;\n        $this->createdAt = $event->createdAt;\n    }\n}\n","mutants":[{"id":"445e7a9e81e060bb248b37d0ff4db994","mutatorName":"PublicVisibility","replacement":"protected static function create(string $title): self","description":"Replaces the `public` method visibility keyword with `protected`.","location":{"start":{"line":16,"column":5},"end":{"line":16,"column":55}},"status":"Killed","statusReason":"PHPUnit 12.1.6 by Sebastian Bergmann and contributors.\n\nRuntime:       PHP 8.3.19\nConfiguration: \/tmp\/infection\/phpunitConfiguration.445e7a9e81e060bb248b37d0ff4db994.infection.xml\n\n.E                                                                  2 \/ 2 (100%)\n\nTime: 00:00.007, Memory: 12.00 MB\n\nThere was 1 error:\n\n1) Blog\\Tests\\Unit\\Post\\PostTest::testCreateNewPostIsValid\nError: Call to protected method Ruvos\\Blog\\DomainObject\\Post\\Post::create() from scope Blog\\Tests\\Unit\\Post\\PostTest\n\n\/var\/www\/html\/tests\/Unit\/Post\/PostTest.php:25\n\nERRORS!\nTests: 2, Assertions: 2, Errors: 1.","coveredBy":["23d143e0b6e1000a7667411c44cfd5cb"],"killedBy":["23d143e0b6e1000a7667411c44cfd5cb"],"testsCompleted":2},{"id":"04cbc49f958f54a696f6d3fd3cc738c7","mutatorName":"MethodCallRemoval","replacement":"","description":"Removes the method call.","location":{"start":{"line":21,"column":9},"end":{"line":21,"column":43}},"status":"Killed","statusReason":"PHPUnit 12.1.6 by Sebastian Bergmann and contributors.\n\nRuntime:       PHP 8.3.19\nConfiguration: \/tmp\/infection\/phpunitConfiguration.04cbc49f958f54a696f6d3fd3cc738c7.infection.xml\n\n.E                                                                  2 \/ 2 (100%)\n\nTime: 00:00.007, Memory: 12.00 MB\n\nThere was 1 error:\n\n1) Blog\\Tests\\Unit\\Post\\PostTest::testCreateNewPostIsValid\nError: Typed property Ruvos\\Blog\\DomainObject\\Post\\Post::$title must not be accessed before initialization\n\n\/var\/www\/html\/src\/DomainObject\/Post\/Post.php:22\n\/var\/www\/html\/tests\/Unit\/Post\/PostTest.php:27\n\nERRORS!\nTests: 2, Assertions: 2, Errors: 1.","coveredBy":["23d143e0b6e1000a7667411c44cfd5cb"],"killedBy":["23d143e0b6e1000a7667411c44cfd5cb"],"testsCompleted":2},{"id":"14468ec2cbc99dac1866d7e3e993c7de","mutatorName":"PublicVisibility","replacement":"protected function getTitle(): string","description":"Replaces the `public` method visibility keyword with `protected`.","location":{"start":{"line":26,"column":5},"end":{"line":26,"column":39}},"status":"Killed","statusReason":"PHPUnit 12.1.6 by Sebastian Bergmann and contributors.\n\nRuntime:       PHP 8.3.19\nConfiguration: \/tmp\/infection\/phpunitConfiguration.14468ec2cbc99dac1866d7e3e993c7de.infection.xml\n\nE\n\nTime: 00:00.007, Memory: 12.00 MB\n\nThere was 1 error:\n\n1) Blog\\Tests\\Unit\\Post\\PostTest::testCreateExistingFromEventsIsValid\nError: Call to protected method Ruvos\\Blog\\DomainObject\\Post\\Post::getTitle() from scope Blog\\Tests\\Unit\\Post\\PostTest\n\n\/var\/www\/html\/tests\/Unit\/Post\/PostTest.php:38\n\nERRORS!\nTests: 1, Assertions: 1, Errors: 1.","coveredBy":["7ce66058bebfa54ae91b7fbe8a95fbe1","23d143e0b6e1000a7667411c44cfd5cb"],"killedBy":["7ce66058bebfa54ae91b7fbe8a95fbe1"],"testsCompleted":1},{"id":"5a6b030b4efb05d0d4f759200be1acdd","mutatorName":"MethodCallRemoval","replacement":"","description":"Removes the method call.","location":{"start":{"line":35,"column":17},"end":{"line":35,"column":54}},"status":"Killed","statusReason":"PHPUnit 12.1.6 by Sebastian Bergmann and contributors.\n\nRuntime:       PHP 8.3.19\nConfiguration: \/tmp\/infection\/phpunitConfiguration.5a6b030b4efb05d0d4f759200be1acdd.infection.xml\n\nE\n\nTime: 00:00.006, Memory: 12.00 MB\n\nThere was 1 error:\n\n1) Blog\\Tests\\Unit\\Post\\PostTest::testCreateExistingFromEventsIsValid\nError: Typed property Ruvos\\Blog\\DomainObject\\Post\\Post::$title must not be accessed before initialization\n\n\/var\/www\/html\/src\/DomainObject\/Post\/Post.php:22\n\/var\/www\/html\/tests\/Unit\/Post\/PostTest.php:38\n\nERRORS!\nTests: 1, Assertions: 1, Errors: 1.","coveredBy":["7ce66058bebfa54ae91b7fbe8a95fbe1","23d143e0b6e1000a7667411c44cfd5cb"],"killedBy":["7ce66058bebfa54ae91b7fbe8a95fbe1"],"testsCompleted":1},{"id":"04b1784821fdb413bff9e737d0edf04a","mutatorName":"Throw_","replacement":"DomainObjectException::unsupportedEvent($event);","description":"Removes a throw statement (`throw`). For example:\n\n```php\nthrow new Exception();\n```\n\nWill be mutated to:\n\n```php\nnew Exception();\n```\n","location":{"start":{"line":38,"column":17},"end":{"line":38,"column":71}},"status":"NoCoverage","statusReason":"","coveredBy":[],"killedBy":[],"testsCompleted":0}]}},"testFiles":{"\/var\/www\/html\/tests\/Integration\/SqLiteEventStoreTest.php":{"tests":[{"id":"64ef5638c42ee3ff7b484611666b28c1","name":"Blog\\Tests\\Integration\\SqLiteEventStoreTest::testSaveIsValid"}]},"\/var\/www\/html\/tests\/Unit\/Post\/Event\/PostCreatedEventTest.php":{"tests":[{"id":"1cc7876205d48b19fbe9172f8218b4f4","name":"Blog\\Tests\\Unit\\Post\\Event\\PostCreatedEventTest::testCreateIsValid"},{"id":"e5b8be9903130ce8bc5b7201cea6c7c9","name":"Blog\\Tests\\Unit\\Post\\Event\\PostCreatedEventTest::testTitleIsCorrectSet"},{"id":"8ec0d35f0017dbab68eb811052c69a04","name":"Blog\\Tests\\Unit\\Post\\Event\\PostCreatedEventTest::testCreatedAtIsValid"},{"id":"790e80b782ab58c130d4af4dd4737b53","name":"Blog\\Tests\\Unit\\Post\\Event\\PostCreatedEventTest::testToJsonIsValid"},{"id":"546f2f99ba298ac94227318dab48ed8b","name":"Blog\\Tests\\Unit\\Post\\Event\\PostCreatedEventTest::testFromJsonIsValid"}]},"\/var\/www\/html\/tests\/Unit\/Post\/PostTest.php":{"tests":[{"id":"23d143e0b6e1000a7667411c44cfd5cb","name":"Blog\\Tests\\Unit\\Post\\PostTest::testCreateNewPostIsValid"},{"id":"7ce66058bebfa54ae91b7fbe8a95fbe1","name":"Blog\\Tests\\Unit\\Post\\PostTest::testCreateExistingFromEventsIsValid"}]}},"framework":{"name":"Infection","branding":{"homepageUrl":"https:\/\/infection.github.io\/","imageUrl":"https:\/\/infection.github.io\/images\/logo.png"}}}
            ;
        </script>
    </body>
</html>